{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Paul\\\\Documents\\\\git\\\\drouotGitRepo\\\\miniDrouot\\\\drouot_Front\\\\src\\\\components\\\\login\\\\SignInForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport { Formik, Form as FromikForm, Field } from 'formik';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport * as Yup from 'yup';\nimport { login } from '../../actions/login';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setUser } from '../../actions/user';\nimport { getUserSessionSuccess, getSessionSuccess } from '../../../node_modules/redux-react-session/dist/a';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SignInSchema = Yup.object().shape({\n  email: Yup.string().email('Invalid email').required('Required'),\n  password: Yup.string().min(2, 'Too Short!').max(18, 'Too Long!').required('Required')\n});\nexport const SignInForm = () => {\n  _s();\n\n  const isLoggedIn = useSelector(state => state.login);\n  const currentUser = useSelector(state => state.user);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    console.log(currentUser);\n    console.log(isLoggedIn);\n  }, [currentUser, isLoggedIn]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Formik, {\n      initialValues: {\n        email: '',\n        password: ''\n      },\n      validationSchema: SignInSchema,\n      onSubmit: values => {\n        fetch(`http://localhost:8080/login`, {\n          method: 'POST',\n          body: JSON.stringify(values)\n        }).then(response => {\n          if (response.ok) {\n            return response.json();\n          } else {\n            throw response;\n          }\n        }).then(response => {\n          dispatch(login());\n          const user = {\n            id: response.ID,\n            firstName: response.firstName,\n            lastName: response.lastName,\n            address: response.address,\n            email: response.email,\n            role: response.role\n          };\n          dispatch(setUser(user));\n          dispatch(getSessionSuccess(user));\n          dispatch(getUserSessionSuccess(user));\n          sessionStorage.clear();\n          sessionStorage.setItem(\"user name\", user.firstName);\n        }).catch(error => {\n          if (error instanceof Promise) {\n            error.json().then(body => {\n              console.log(body.error);\n            });\n          } else {\n            alert(error);\n          }\n        });\n      },\n      children: ({\n        errors,\n        touched\n      }) => /*#__PURE__*/_jsxDEV(FromikForm, {\n        children: [/*#__PURE__*/_jsxDEV(Field, {\n          className: \"form-control my-2\",\n          name: \"email\",\n          type: \"email\",\n          placeholder: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 13\n        }, this), errors.email && touched.email ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: errors.email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 46\n        }, this) : null, /*#__PURE__*/_jsxDEV(Field, {\n          className: \"form-control my-2\",\n          name: \"password\",\n          type: \"password\",\n          placeholder: \"Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }, this), errors.password && touched.password ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: errors.password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 53\n        }, this) : null, /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-info pull-right\",\n          type: \"submit\",\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 28,\n    columnNumber: 12\n  }, this);\n};\n\n_s(SignInForm, \"hNuvAtPfp8nWqt67xm1GEOjXGiM=\", false, function () {\n  return [useSelector, useSelector, useDispatch];\n});\n\n_c = SignInForm;\nexport default SignInForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignInForm\");","map":{"version":3,"sources":["C:/Users/Paul/Documents/git/drouotGitRepo/miniDrouot/drouot_Front/src/components/login/SignInForm.js"],"names":["React","useEffect","Formik","Form","FromikForm","Field","Yup","login","useDispatch","useSelector","setUser","getUserSessionSuccess","getSessionSuccess","SignInSchema","object","shape","email","string","required","password","min","max","SignInForm","isLoggedIn","state","currentUser","user","dispatch","console","log","values","fetch","method","body","JSON","stringify","then","response","ok","json","id","ID","firstName","lastName","address","role","sessionStorage","clear","setItem","catch","error","Promise","alert","errors","touched"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\r\nimport { Formik, Form as FromikForm, Field } from 'formik';\r\nimport 'bootstrap/dist/css/bootstrap.min.css'\r\nimport * as Yup from 'yup';\r\nimport {login} from '../../actions/login'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { setUser } from '../../actions/user';\r\nimport { getUserSessionSuccess, getSessionSuccess } from '../../../node_modules/redux-react-session/dist/a';\r\n\r\nconst SignInSchema = Yup.object().shape({\r\n   email: Yup.string().email('Invalid email').required('Required'),\r\n   password: Yup.string()\r\n     .min(2, 'Too Short!')\r\n     .max(18, 'Too Long!')\r\n     .required('Required'),\r\n})\r\n\r\nexport const SignInForm = () => {\r\n  const isLoggedIn = useSelector(state => state.login);\r\n  const currentUser = useSelector(state => state.user);\r\n\r\n  const dispatch = useDispatch();\r\n    useEffect(() => {\r\n      console.log(currentUser)\r\n      console.log(isLoggedIn)\r\n        \r\n    }, [currentUser, isLoggedIn])\r\n    return(<div>\r\n      <Formik\r\n        initialValues={{\r\n            email: '',\r\n            password:'',\r\n        }}\r\n        validationSchema={SignInSchema}\r\n        onSubmit={values => {\r\n            fetch(`http://localhost:8080/login`, {method: 'POST', body: JSON.stringify(values)})\r\n            .then(response => {\r\n                if (response.ok) {\r\n                  return response.json();\r\n                }else {\r\n                  throw response;\r\n              }\r\n            }).then(response => {\r\n              dispatch(login());\r\n              const user = {\r\n                id: response.ID,\r\n                firstName: response.firstName,\r\n                lastName:response.lastName,\r\n                address: response.address,\r\n                email: response.email,\r\n                role: response.role\r\n              }\r\n              dispatch(setUser(user));\r\n              dispatch(getSessionSuccess(user))\r\n              dispatch(getUserSessionSuccess(user))\r\n              sessionStorage.clear();\r\n              sessionStorage.setItem(\"user name\",user.firstName);\r\n              \r\n            }).catch(error => {\r\n              if (error instanceof Promise) {\r\n                error.json().then((body) => {\r\n                  console.log(body.error);\r\n                });\r\n              }else {\r\n                alert(error)\r\n              }\r\n                \r\n            })\r\n        }}\r\n      >\r\n        {({ errors, touched }) => (\r\n          <FromikForm> \r\n            <Field className=\"form-control my-2\" name=\"email\" type=\"email\" placeholder=\"Email\" />\r\n            {errors.email && touched.email ? <div>{errors.email}</div> : null}\r\n\r\n            <Field className=\"form-control my-2\" name=\"password\" type=\"password\" placeholder=\"Password\" />\r\n            {errors.password && touched.password ? (<div>{errors.password}</div>) : null}\r\n\r\n            <button className=\"btn btn-info pull-right\" type=\"submit\">Submit</button>\r\n \r\n          </FromikForm>\r\n        )}\r\n      </Formik>\r\n    </div>)\r\n}\r\n\r\n  export default SignInForm"]},"metadata":{},"sourceType":"module"}